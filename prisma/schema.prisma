// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Pokemon {
  id                  Int               @id @default(autoincrement())
  name                String
  pokedexNumber       Int               @unique
  photoUrl            String?          
  description         String?           
  heightCm            Float?            
  weightKg            Float?            
  genderFemaleRatio   Float?            
  genderMaleRatio     Float?            
  createdAt           DateTime          @default(now())
  updatedAt           DateTime          @updatedAt

  types               PokemonType[]
  abilities           PokemonAbility[]
  eggGroups           PokemonEggGroup[]
  evolutionsFrom      Evolution[]       @relation("EvolutionTo")
  evolutionsTo        Evolution[]       @relation("EvolutionFrom")
}

model Type {
  id        Int             @id @default(autoincrement())
  name      String          @unique     // e.g. "Electric", "Grass", "Water"
  pokemons  PokemonType[]
}

model PokemonType {
  pokemon   Pokemon @relation(fields: [pokemonId], references: [id])
  pokemonId Int
  type      Type    @relation(fields: [typeId], references: [id])
  typeId    Int

  @@id([pokemonId, typeId])
}

model Ability {
  id        Int               @id @default(autoincrement())
  name      String            @unique    // e.g. "Static", "Overgrow", "Chlorophyll"
  pokemons  PokemonAbility[]
}

model PokemonAbility {
  pokemon    Pokemon @relation(fields: [pokemonId], references: [id])
  pokemonId  Int
  ability    Ability @relation(fields: [abilityId], references: [id])
  abilityId  Int

  @@id([pokemonId, abilityId])
}

model EggGroup {
  id        Int              @id @default(autoincrement())
  name      String           @unique    // e.g. "Monster", "Grass", "Fairy"
  pokemons  PokemonEggGroup[]
}

model PokemonEggGroup {
  pokemon      Pokemon  @relation(fields: [pokemonId], references: [id])
  pokemonId    Int
  eggGroup     EggGroup @relation(fields: [eggGroupId], references: [id])
  eggGroupId   Int

  @@id([pokemonId, eggGroupId])
}


model Evolution {
  id              Int      @id @default(autoincrement())
  
  fromPokemon     Pokemon  @relation("EvolutionFrom", fields: [fromId], references: [id])
  fromId          Int

  toPokemon       Pokemon  @relation("EvolutionTo", fields: [toId], references: [id])
  toId            Int

  method          String?  
  evolutionPhotoUrl String?
  
  createdAt       DateTime  @default(now())
}
